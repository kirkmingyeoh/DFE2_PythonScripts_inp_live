# Instructions 

This document details the general instructions to run the Python scripts in this repository to generate Direct FE2 input files for Abaqus. These are general instructions which are applicable across all scripts. Specific instructions unique to particular scripts should be detailed within the respective scripts. 

-----
User-provided Abaqus input files
-----
Two Abaqus input files need to be provided by the user - one each to describe the macroscale problem as well as the microscale RVE. This can be generated through Abaqus' CAE interface. 

1) Macroscale input file - This input file should contain all the information detailing the macroscale problem to be analysed. The macroscale Part and Instance should be meshed and assigned an Elastic material with arbitrary property values. The script will replace the arbitrary material with null material properties. The boundary conditions should also be imposed on the macroscale Instance, and all other analysis settings such as time increment should be included. 

2) Microscale input file - This input file should contain all the information detailing the microscale RVE of the macroscale structure. The RVE should be rectangular (2D) or cuboidal (3D) and aligned along the global x, y and z axes. The RVE should also be periodic with the appropriate materials assigned to the corresponding regions. An Instance should be included in the Assembly such that the Part information will be captured when the input file is generated. No other analysis information is required.

Note that additional instructions or preparations might be needed for advanced or customised scripts, and should be detailed within the respective scripts. 

These two user-provided Abaqus input files, the user input file (DFE2_0_UserInput.py) as well as the main Python script should then be placed in a folder/directory. 

-----
User-provided information to the Python script
-----
Once the relevant files are placed in a folder/directory, the following information needs to be updated in the user input file:
1) Name of the macroscale input file
2) Name of the microscale input file
3) Intended name for the Direct FE2 input file that the script will generate

Users may also specify additional information such as the number of integration points per macroscale element as well as tolerance for floating point comparisons. Some of these additional information may be required for advanced or customised scripts, and should be detailed within the respective scripts.

-----
Executing the Python script
-----
Once the user-defined inputs have been specified in the user input file, the main Python script can then be executed. Note that the script is written in Python 2.7, which can either be run with Abaqus' in-built Python compiler (either through CAE or CAE nogui, in 2024 or earlier versions) or with a compatible Python IDE. 

If using Abaqus CAE:
1) Change the working directory to the folder/directory where the files are residing through 'File' > 'Set Work Directory' and select the folder/directory.
2) Execute the main Python script through 'File' > 'Run Script' and select the main Python script.

If using other Python IDEs, including Abaqus CAE nogui:
1) Change the working directory to the folder/directory where the files are residing using the following commands.   
   '''   
   import os   
   os.chdir('path\to\directory')   
   '''   
2) Execute the main Python script using the following command.   
   '''   
   execfile('name_of_main_Python_script')   
   '''   

-----
Abaqus input file returned by the Python script
-----
The Python script will return a correspondingly named Direct FE2 input file to the same working directory. Volume-scaled microscale RVEs have been placed at the integration points of the macroscale mesh and multi-point constraints to link the degrees of freedom of both scales have been included. This input file can then be directly submitted as a job to Abaqus. 

The results returned by Abaqus can be directly visualized in Abaqus CAE's Visualization module without any additional post-processing. 

-----
Validating the Direct FE2 multiscale model
-----
The Direct FE2 model generated by the Python scripts can theoretically be validated by comparing its results with those from a corresponding finely meshed DNS model. However, in practice, the DNS model would likely be computationally too costly, forming the motivation for using the Direct FE2 model in the first place. Nevertheless, validation can still be performed using a homogeneous test case.

First, generate another Direct FE2 model using the same macroscale input file but with a homogeneous RVE. This RVE can be arbitrarily meshed, or even have the same mesh as the original heterogeneous RVE, as along as all elements are assigned the same material property. The corresponding DNS model would be obtained by assigning the same material property to the macroscale mesh and performing a macroscale-only analysis. The results from these two models should match if the Direct FE2 model is generated correctly. 

Alternatively, this validation can also be performed with a simpler heterogeneous RVE. Similarly, a Direct FE2 model should first be generated using the same macroscale input file but with a simpler heterogeneous RVE. The corresponding DNS model can be obtained by tessellating the RVE to generate the full structure. Care must be taken when imposing the boundary conditions to ensure that they are equivalent in both the coarsely meshed Direct FE2 model and finely meshed DNS model. Similarly, the results from these two models should match if the Direct FE2 model is generated correctly.
